function C(){F(),p(),s(),B(),v(),K(z.offsetWidth,z.offsetHeight),o()}function F(){g=new CAV.CanvasRenderer,H(x.renderer)}function H(a){switch(D&&w.removeChild(D.element),a){case m:D=g}D.setSize(z.offsetWidth,z.offsetHeight),w.appendChild(D.element)}function p(){I=new CAV.Scene}function s(){I.remove(h),D.clear(),q=new CAV.Plane(t.width*D.width,t.height*D.height,t.segments,t.slices),y=new CAV.Material(t.ambient,t.diffuse),h=new CAV.Mesh(q,y),I.add(h);var a,b;for(a=q.vertices.length-1;a>=0;a--)b=q.vertices[a],b.anchor=CAV.Vector3.clone(b.position),b.step=CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),b.time=Math.randomInRange(0,Math.PIM2)}function B(){var a,b;for(a=I.lights.length-1;a>=0;a--)b=I.lights[a],I.remove(b);for(D.clear(),a=0;a<G.count;a++)b=new CAV.Light(G.ambient,G.diffuse),b.ambientHex=b.ambient.format(),b.diffuseHex=b.diffuse.format(),I.add(b),b.mass=Math.randomInRange(.5,1),b.velocity=CAV.Vector3.create(),b.acceleration=CAV.Vector3.create(),b.force=CAV.Vector3.create()}function K(a,b){D.setSize(a,b),CAV.Vector3.set(L,D.halfWidth,D.halfHeight),s()}function o(){i=Date.now()-n,u(),M(),requestAnimationFrame(o)}function u(){var a,b,c,d,e,f,g,h=t.depth/2;for(CAV.Vector3.copy(G.bounds,L),CAV.Vector3.multiplyScalar(G.bounds,G.xyScalar),CAV.Vector3.setZ(k,G.zOffset),d=I.lights.length-1;d>=0;d--){e=I.lights[d],CAV.Vector3.setZ(e.position,G.zOffset);var j=Math.clamp(CAV.Vector3.distanceSquared(e.position,k),G.minDistance,G.maxDistance),l=G.gravity*e.mass/j;CAV.Vector3.subtractVectors(e.force,k,e.position),CAV.Vector3.normalise(e.force),CAV.Vector3.multiplyScalar(e.force,l),CAV.Vector3.set(e.acceleration),CAV.Vector3.add(e.acceleration,e.force),CAV.Vector3.add(e.velocity,e.acceleration),CAV.Vector3.multiplyScalar(e.velocity,G.dampening),CAV.Vector3.limit(e.velocity,G.minLimit,G.maxLimit),CAV.Vector3.add(e.position,e.velocity)}for(f=q.vertices.length-1;f>=0;f--)g=q.vertices[f],a=Math.sin(g.time+g.step[0]*i*t.speed),b=Math.cos(g.time+g.step[1]*i*t.speed),c=Math.sin(g.time+g.step[2]*i*t.speed),CAV.Vector3.set(g.position,t.xRange*q.segmentWidth*a,t.yRange*q.sliceHeight*b,t.zRange*h*c-h),CAV.Vector3.add(g.position,g.anchor);q.dirty=!0}function M(){D.render(I)}function J(a){var b,c,d=a,e=function(a){for(b=0,l=I.lights.length;b<l;b++)c=I.lights[b],c.ambient.set(a),c.ambientHex=c.ambient.format()},f=function(a){for(b=0,l=I.lights.length;b<l;b++)c=I.lights[b],c.diffuse.set(a),c.diffuseHex=c.diffuse.format()};return{set:function(){e(d[0]),f(d[1])}}}function v(){window.addEventListener("resize",j)}function A(a){CAV.Vector3.set(k,a.x,D.height-a.y),CAV.Vector3.subtract(k,L)}function j(a){K(z.offsetWidth,z.offsetHeight),M()}function changeC(){J(h[2]).set()}var t={width:1.5,height:1.5,depth:10,segments:12,slices:6,xRange:.8,yRange:.1,zRange:1,ambient:"#525252",diffuse:"#FFFFFF",speed:2e-4},G={count:2,xyScalar:1,zOffset:100,ambient:"#002c4a",diffuse:"#005584",speed:.001,gravity:1200,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!1,draw:!1,bounds:CAV.Vector3.create(),step:CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},m="canvas",E="svg",x={renderer:m},i,n=Date.now(),L=CAV.Vector3.create(),k=CAV.Vector3.create(),z=document.getElementById("container"),w=document.getElementById("anitOut"),D,I,h,q,y,g,r;C();var h=[["#002c4a","#005584"],["#35ac03","#3f4303"],["#ac0908","#cd5726"],["#18bbff","#00486b"]];